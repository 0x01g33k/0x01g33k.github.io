![2025-05-27 13_07_29-EG-CTF Final 2025 — Mozilla Firefox.png]({{site.baseurl}}/_assets/2025-05-27 13_07_29-EG-CTF Final 2025 — Mozilla Firefox.png)

Hello guys, for the first time I had the honor to write the Digital Forensics Challenges for EG|CERT's CTF, this round was wild, I wanted to create some intersting challenges with new ideas and concepts that helps in making DF investigation more relatable and shed some light on the nature of the daily of a DF investigator. So, without any further a due, let's dive into the writeup.

## First Challenge: The X archives

![2025-05-27 13_21_56-Admin Panel — Mozilla Firefox.png]({{site.baseurl}}/_assets/2025-05-27 13_21_56-Admin Panel — Mozilla Firefox.png)

Description: ```During a regular investigation, our DFIR engineer stumbled upon the path to the archive, which the perpetraor claims he didn't download it or access it. Could you get the path of the file?

Flag Format: EGCTF{Drive:\example\example\file.xxx}```

In created two warmup challenges for this round, this was the first one of them. In this challenge, the idea was simple, there's a certain ```*.rar``` file that was opened on the user's machine, and the flag is the full path of that file. The players were presented with ```.hiv``` file, which they can open in ```registry explorer``` or any other specialized tool.

If we opened in in ```regsitry explorer```, we will find the hive as follows.

![2025-05-27 13_59_00-Win10 NEW2 - VMware Workstation.png]({{site.baseurl}}/_assets/2025-05-27 13_59_00-Win10 NEW2 - VMware Workstation.png)

From the challenge's description, it's quite clear we're looking for an archive, if we went straight to the path of winrar application and viewed the contents of "ArcHistory", we will find the file's path and its name.

![2025-05-27 14_12_49-2025-05-27 13_59_00-Win10 NEW2 - VMware Workstation-2.png]({{site.baseurl}}/_assets/2025-05-27 14_12_49-2025-05-27 13_59_00-Win10 NEW2 - VMware Workstation-2.png)

Flag:```EGCTF{C:\Users\CAIOS\Desktop\Warmup2.rar}```

## Second Challenge: Data Mirage

![2025-05-27 14_15_16-Admin Panel — Mozilla Firefox.png]({{site.baseurl}}/_assets/2025-05-27 14_15_16-Admin Panel — Mozilla Firefox.png)

Description:```Our team was able to acquire a logical image from the perpetrator's machine, but they couldn't find the file which the perpetrator opened, could you find the file?

Flag Format: EGCTF{SENTENCE}
Challenge Link: https://drive.google.com/file/d/1i5pm5RXG1tZltg_9VjX66wNEtGLsAtWa/view?usp=sharing```

This is the second warmup challenge, which is a follow up from the first one. In this challenge, the players are presented with AD1 logical image from the user's machine, on which the user downloaded the file. The task is simple, find the temp directory which was generated by ```winrar``` which holds the flag.


![2025-05-27 14_23_33-Win10 NEW2 - VMware Workstation.png]({{site.baseurl}}/_assets/2025-05-27 14_23_33-Win10 NEW2 - VMware Workstation.png)


The flag is XORed, if we tried any online tool to bruteforce it like ```cyberchef```, we will get the flag.

![2025-05-27 14_25_53-XOR Brute Force - CyberChef — Mozilla Firefox.png]({{site.baseurl}}/_assets/2025-05-27 14_25_53-XOR Brute Force - CyberChef — Mozilla Firefox.png)


Flag:```EGCTF{Brut3F0rc!ng_&X0r_1$_FuN}```

## Third Challenge: You Got a message

![2025-05-27 14_27_33-Admin Panel — Mozilla Firefox.png]({{site.baseurl}}/_assets/2025-05-27 14_27_33-Admin Panel — Mozilla Firefox.png)

Description:```Our Digital Forensics team acquired a sim card image for the notorious criminal R.Red, your task as a Digital Forensics analyst to retrieve the messages from the sim card ,the number which the message was sent from, and the perpetrator's username who sent it.

Flag Format: EGCTF{Mob No.,message,username}```

Okay, this is where the fun begins, in this challenge I wanted to introduce the idea that you can investigate and analyze a SIM Card and gain useful insights. The task in this challenge is quite simple, the players are presented with a SIM Card img file and they need to extract 2 important parts from the img. First they need to get the message that was received by R.Red, second they need to find the sender's mobile number. 

Last part is to find the username of the perpetrator who sent the message, which in our case, is a ```scammer```.

Let's start with the easy part, we can view the img in ```FTK imager``` or simply extract the files from the img both options are suitable.

Upon viewing/extracting the files from the img, we will find the following files and directories.

![2025-05-27 14_38_38-Ubuntu-NEW - VMware Workstation.png]({{site.baseurl}}/_assets/2025-05-27 14_38_38-Ubuntu-NEW - VMware Workstation.png)

Okay, now we will go to directory named ```MF GSM```, to get the contents of a file named ```EF_SMS```, which holds the data of the message.

![2025-05-27 14_40_48-Ubuntu-NEW - VMware Workstation.png]({{site.baseurl}}/_assets/2025-05-27 14_40_48-Ubuntu-NEW - VMware Workstation.png)
When we decode the B64 encoded string, we will get the message which is ```SM$_F0r3ns!c$_1s_@w3s0me```.

Now for the tricky part, we need to find the message sender's mobile number. We will view the ```EF_SMS``` file in any hex editor, and we will find the following values.

![2025-05-27 14_44_53-Ubuntu-NEW - VMware Workstation.png]({{site.baseurl}}/_assets/2025-05-27 14_44_53-Ubuntu-NEW - VMware Workstation.png)

The values ```0B91```, mean that it's an international number with 11 digits, and the following values represent the number itself.

Now we got two parts of the flag, we need to find the last part which is the scammer's username. Since it's a scammer, we will go to ```scamsearch.io```, and use the advanced search feature to search for a close match of the number in question.

![2025-05-27 14_50_32-Global Scammer Database - Catch a Scammer — Mozilla Firefox.png]({{site.baseurl}}/_assets/2025-05-27 14_50_32-Global Scammer Database - Catch a Scammer — Mozilla Firefox.png)


We will find the username is ```dreaminlace```.

Now we got all three parts of the flag.

Flag:```EGCTF{15132893723,SM$_F0r3ns!c$_1s_@w3s0me,dreaminlace}```


## Fourth Challenge The Drain Directive

![2025-05-27 14_55_55-Admin Panel — Mozilla Firefox.png]({{site.baseurl}}/_assets/2025-05-27 14_55_55-Admin Panel — Mozilla Firefox.png)

Description:```A hacker managed to exploit a vulnerability in a DeFi bank smart contract, he was able to transfer all the money from the bank's contract to his wallet, your task as a DF analyst is to find the attacker's wallet, and analyze the hacker's malicious smart contract to find the function which is responsible for the withdrawal.

Contract address: 0x228de92D039C480d3951597AFe4d434344004A9f

Flag Format: EGCTF{address,opcode hex}```

